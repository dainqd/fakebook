<!DOCTYPE html>
<html lang="en">
<head th:insert="fragments/main.html :: header-main(Messager)"></head>
<style>
    .imgUserThumbnail {
        width: 100%;
        height: 400px !important;
    }

    .imgUserAvatar {
        width: 200px;
        height: 200px !important;
    }

    .top-right {
        position: absolute;
        top: 8px;
        right: 16px;
    }

    .imageDemo {
        position: relative;
        text-align: center;
        color: white;
    }
</style>
<body>
<div class="theme-layout">
    <div class="" th:insert="fragments/main.html :: headerMain"></div>

    <section>
        <div class="feature-photo">
            <figure><img src="" class="imgUserThumbnail" alt=""></figure>
            <div class="add-btn">
                <span>1205 followers</span>
                <a href="#" title="" data-ripple="">Add Friend</a>
            </div>
            <form class="edit-phto d-none">
                <i class="fa fa-camera-retro"></i>
                <label class="fileContainer">
                    Edit Cover Photo
                    <input id="" type="file"/>
                </label>
            </form>
            <div class="container-fluid">
                <div class="row merged">
                    <div class="col-lg-2 col-sm-3">
                        <div class="user-avatar">
                            <figure>
                                <img class="imgUserAvatar" alt="">
                                <div class="imageDemo d-none">
                                    <img class="imgUserAvatarDemo" alt="">
                                    <button class="top-right btn btn-warning">Review Image</button>
                                </div>
                                <form class="edit-phto">
                                    <i class="fa fa-camera-retro"></i>
                                    <label class="fileContainer" data-toggle="modal"
                                           data-target="#modalUploadAvt">
                                        Edit Display Photo
                                    </label>
                                </form>
                            </figure>
                        </div>
                    </div>
                    <div class="col-lg-10 col-sm-9">
                        <div class="timeline-info">
                            <ul>
                                <li>
                                    <button id="btnSaveAvt" class="d-none btn btn-success">Save</button>
                                </li>
                                <li class="admin-name">
                                    <h5 class="fullName">Janice Griffith</h5>
                                    <span class="username">Group Admin</span>
                                </li>
                                <li>
                                    <a class="active" href="time-line.html" title="" data-ripple="">time line</a>
                                    <a class="" href="timeline-photos.html" title="" data-ripple="">Photos</a>
                                    <a class="" href="timeline-videos.html" title="" data-ripple="">Videos</a>
                                    <a class="" href="timeline-friends.html" title="" data-ripple="">Friends</a>
                                    <a class="" href="groups.html" title="" data-ripple="">Groups</a>
                                    <a class="" href="about.html" title="" data-ripple="">about</a>
                                    <a class="" href="#" title="" data-ripple="">more</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section>
        <div class="gap gray-bg">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="row" id="page-contents">
                            <div class="col-lg-3">
                                <aside class="sidebar static">
                                    <div class="advertisment-box">
                                        <h4 class="">advertisment</h4>
                                        <figure>
                                            <a href="#" title="Advertisment"><img
                                                    th:src="@{/main/images/resources/ad-widget.jpg}"
                                                    alt=""></a>
                                        </figure>
                                    </div>
                                    <div class="widget stick-widget">
                                        <h4 class="widget-title">Shortcuts</h4>
                                        <ul class="naves">
                                            <li>
                                                <i class="ti-clipboard"></i>
                                                <a href="newsfeed.html" title="">News feed</a>
                                            </li>
                                            <li>
                                                <i class="ti-mouse-alt"></i>
                                                <a href="inbox.html" title="">Inbox</a>
                                            </li>
                                            <li>
                                                <i class="ti-files"></i>
                                                <a href="fav-page.html" title="">My pages</a>
                                            </li>
                                            <li>
                                                <i class="ti-user"></i>
                                                <a href="timeline-friends.html" title="">friends</a>
                                            </li>
                                            <li>
                                                <i class="ti-image"></i>
                                                <a href="timeline-photos.html" title="">images</a>
                                            </li>
                                            <li>
                                                <i class="ti-video-camera"></i>
                                                <a href="timeline-videos.html" title="">videos</a>
                                            </li>

                                        </ul>
                                    </div><!-- Shortcuts -->
                                </aside>
                            </div><!-- sidebar -->
                            <div class="col-lg-6">
                                <div class="central-meta">
                                    <div class="messages">
                                        <h5 class="f-title"><i class="ti-bell"></i>All Messages <span
                                                class="more-options"><i class="fa fa-ellipsis-h"></i></span></h5>
                                        <div class="message-box">
                                            <ul class="peoples">

                                                <li>

                                                    <figure>
                                                        <img src="images/resources/friend-avatar2.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Molly cyrus</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar3.jpg" alt="">
                                                        <span class="status f-away"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Andrew</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure>
                                                        <img src="images/resources/friend-avatar.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>

                                                    <div class="people-name">
                                                        <span>jason bourne</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar4.jpg" alt="">
                                                        <span class="status off-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Sarah Grey</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar5.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>bill doe</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar6.jpg" alt="">
                                                        <span class="status f-away"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>shen cornery</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar7.jpg" alt="">
                                                        <span class="status off-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>kill bill</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar8.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>jasmin walia</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar6.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>neclos cage</span>
                                                    </div>
                                                </li>
                                            </ul>
                                            <div class="peoples-mesg-box">
                                                <div class="conversation-head">
                                                    <figure><img src="images/resources/friend-avatar.jpg" alt="">
                                                    </figure>
                                                    <span>jason bourne <i>online</i></span>
                                                </div>
                                                <ul class="chatting-area">
                                                    <li class="you">
                                                        <figure><img src="images/resources/userlist-2.jpg" alt="">
                                                        </figure>
                                                        <p>what's liz short for? :)</p>
                                                    </li>
                                                    <li class="me">
                                                        <figure><img src="images/resources/userlist-1.jpg" alt="">
                                                        </figure>
                                                        <p>Elizabeth lol</p>
                                                    </li>
                                                    <li class="me">
                                                        <figure><img src="images/resources/userlist-1.jpg" alt="">
                                                        </figure>
                                                        <p>wanna know whats my second guess was?</p>
                                                    </li>
                                                    <li class="you">
                                                        <figure><img src="images/resources/userlist-2.jpg" alt="">
                                                        </figure>
                                                        <p>yes</p>
                                                    </li>
                                                    <li class="me">
                                                        <figure><img src="images/resources/userlist-1.jpg" alt="">
                                                        </figure>
                                                        <p>Disney's the lizard king</p>
                                                    </li>
                                                    <li class="me">
                                                        <figure><img src="images/resources/userlist-1.jpg" alt="">
                                                        </figure>
                                                        <p>i know him 5 years ago</p>
                                                    </li>
                                                    <li class="you">
                                                        <figure><img src="images/resources/userlist-2.jpg" alt="">
                                                        </figure>
                                                        <p>coooooooooool dude ;)</p>
                                                    </li>
                                                </ul>
                                                <div class="message-text-container">
                                                    <form method="post">
                                                        <textarea></textarea>
                                                        <button title="send"><i class="fa fa-paper-plane"></i></button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div><!-- centerl meta -->
                            <div class="col-lg-3">
                                <aside class="sidebar static">
                                    <div class="widget">
                                        <h4 class="widget-title">Socials</h4>
                                        <ul class="socials">
                                            <li class="facebook">
                                                <a title="" href="#"><i class="fa fa-facebook"></i>
                                                    <span>facebook</span>
                                                    <ins>45 likes</ins>
                                                </a>
                                            </li>
                                            <li class="twitter">
                                                <a title="" href="#"><i class="fa fa-twitter"></i> <span>twitter</span>
                                                    <ins>25 likes</ins>
                                                </a>
                                            </li>
                                            <li class="google">
                                                <a title="" href="#"><i class="fa fa-google"></i> <span>google</span>
                                                    <ins>35 likes</ins>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="widget stick-widget">
                                        <h4 class="widget-title">Who's follownig</h4>
                                        <ul class="followers">
                                            <li>
                                                <figure><img src="images/resources/friend-avatar2.jpg" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a href="time-line.html" title="">Kelly Bill</a></h4>
                                                    <a href="#" title="" class="underline">Add Friend</a>
                                                </div>
                                            </li>
                                            <li>
                                                <figure><img src="images/resources/friend-avatar4.jpg" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a href="time-line.html" title="">Issabel</a></h4>
                                                    <a href="#" title="" class="underline">Add Friend</a>
                                                </div>
                                            </li>
                                            <li>
                                                <figure><img src="images/resources/friend-avatar6.jpg" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a href="time-line.html" title="">Andrew</a></h4>
                                                    <a href="#" title="" class="underline">Add Friend</a>
                                                </div>
                                            </li>
                                            <li>
                                                <figure><img src="images/resources/friend-avatar8.jpg" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a href="time-line.html" title="">Sophia</a></h4>
                                                    <a href="#" title="" class="underline">Add Friend</a>
                                                </div>
                                            </li>
                                            <li>
                                                <figure><img src="images/resources/friend-avatar3.jpg" alt=""></figure>
                                                <div class="friend-meta">
                                                    <h4><a href="time-line.html" title="">Allen</a></h4>
                                                    <a href="#" title="" class="underline">Add Friend</a>
                                                </div>
                                            </li>
                                        </ul>
                                    </div><!-- who's following -->
                                </aside>
                            </div><!-- sidebar -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- The Modal -->
    <div class="modal" id="modalUploadAvt">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Upload Image</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <div class="modal-body">
                    <input type="file" name="thumbnail" id="uploadThumbnail" required accept="image/*">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" id="submitUpload" data-dismiss="modal">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <input type="text" class="d-none" id="inputAvtUploaded">

    <div class="" th:insert="fragments/main.html :: footerMain"></div>
</div>
</body>
<div th:insert="fragments/main.html :: script-main"></div>
<script th:src="@{/main/js/master.js}"></script>
<script>
    $(document).ready(function () {
        $('#submitUpload').on('click', function (e) {
            e.preventDefault();
            uploadImageMain('uploadThumbnail').then(function (response) {
                $('#btnSaveAvt').removeClass('d-none')
                $('.imgUserAvatar').addClass('d-none')
                $('.imageDemo').removeClass('d-none')
                $('.imgUserAvatarDemo').attr("src", response);
                $('#inputAvtUploaded').val(response);
            }).catch(function (error) {
                console.error('Error:', error);
            });
        });

        $('#btnSaveAvt').on('click', function () {
            changeAvt();
        })
    });

    let myToken = getCookieValue('accessToken');

    async function changeAvt() {
        try {
            let urlChangeAvt = `/api/v1/user/change-avt/` + localStorage.getItem('user_id');
            let requestData =  $('#inputAvtUploaded').val();

            fetch(urlChangeAvt, {
                method: 'PUT',
                headers: {
                    'content-type': 'application/json',
                    'Authorization': `Bearer ` + `${myToken}`
                },
                body: requestData,

            })
                .then(response => {
                    alert('Change avatar success')
                    window.location.reload();
                })
                .catch(error => console.log(error));
        } catch (error) {
            console.error('Error:', error);
        }
    }

</script>
</html>