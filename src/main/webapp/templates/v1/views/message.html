<!DOCTYPE html>
<html lang="en">
<head th:insert="fragments/main.html :: header-main(Messager)"></head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<style>
    .imgUserThumbnail {
        width: 100%;
        height: 400px !important;
    }

    .imgUserAvatar {
        width: 200px;
        height: 200px !important;
    }

    .top-right {
        position: absolute;
        top: 8px;
        right: 16px;
    }

    .imageDemo {
        position: relative;
        text-align: center;
        color: white;
    }

    .chat-message {
        margin-bottom: 10px;
        clear: both;
    }

    .chat-message-img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        margin-right: 10px;
        float: left;
    }

    .cursor {
        cursor: pointer !important;
    }
</style>
<body>
<div class="theme-layout">
    <div class="" th:insert="fragments/main.html :: headerMain"></div>

    <section>
        <div class="feature-photo">
            <figure><img src="" class="imgUserThumbnail" id="imgUserThumbnail" alt=""></figure>
            <div class="add-btn">
                <a title="" id="btnEditCoverPhoto" data-toggle="modal" class="cursor"
                   data-target="#modalUploadThumbnail">Edit Cover Photo</a>
                <a title="" class="cursor d-none" id="btnSaveCoverPhoto">Save Cover Photo</a>
            </div>
            <div class="container-fluid">
                <div class="row merged">
                    <div class="col-lg-2 col-sm-3">
                        <div class="user-avatar" style="cursor: pointer">
                            <figure>
                                <img class="imgUserAvatar" alt="">
                                <div class="imageDemo d-none">
                                    <img class="imgUserAvatarDemo" alt="">
                                    <button class="top-right btn btn-warning">Review Image</button>
                                </div>
                                <form class="edit-phto" data-toggle="modal"
                                      data-target="#modalUploadAvt">
                                    <i class="fa fa-camera-retro"></i>
                                    <label class="fileContainer">
                                        Edit Display Photo
                                    </label>
                                </form>
                            </figure>
                        </div>
                    </div>
                    <div class="col-lg-10 col-sm-9">
                        <div class="timeline-info">
                            <ul>
                                <li>
                                    <button id="btnSaveAvt" class="d-none btn btn-success">Save</button>
                                </li>
                                <li class="admin-name">
                                    <h5 class="fullName">Janice Griffith</h5>
                                    <span class="username">Group Admin</span>
                                </li>
                                <li>
                                    <a class="active" href="time-line.html" title="" data-ripple="">time line</a>
                                    <a class="" href="timeline-photos.html" title="" data-ripple="">Photos</a>
                                    <a class="" href="timeline-videos.html" title="" data-ripple="">Videos</a>
                                    <a class="" href="timeline-friends.html" title="" data-ripple="">Friends</a>
                                    <a class="" href="groups.html" title="" data-ripple="">Groups</a>
                                    <a class="" href="about.html" title="" data-ripple="">about</a>
                                    <a class="" href="#" title="" data-ripple="">more</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section>
        <div class="gap gray-bg">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="row" id="page-contents">
                            <div class="col-lg-3">
                                <aside class="sidebar static">
                                    <div class="advertisment-box">
                                        <h4 class="">advertisment</h4>
                                        <figure>
                                            <a href="#" title="Advertisment"><img
                                                    th:src="@{/main/images/resources/ad-widget.jpg}"
                                                    alt=""></a>
                                        </figure>
                                    </div>
                                    <div class="widget stick-widget">
                                        <h4 class="widget-title">Shortcuts</h4>
                                        <ul class="naves">
                                            <li>
                                                <i class="ti-clipboard"></i>
                                                <a href="newsfeed.html" title="">News feed</a>
                                            </li>
                                            <li>
                                                <i class="ti-mouse-alt"></i>
                                                <a href="inbox.html" title="">Inbox</a>
                                            </li>
                                            <li>
                                                <i class="ti-files"></i>
                                                <a href="fav-page.html" title="">My pages</a>
                                            </li>
                                            <li>
                                                <i class="ti-user"></i>
                                                <a href="timeline-friends.html" title="">friends</a>
                                            </li>
                                            <li>
                                                <i class="ti-image"></i>
                                                <a href="timeline-photos.html" title="">images</a>
                                            </li>
                                            <li>
                                                <i class="ti-video-camera"></i>
                                                <a href="timeline-videos.html" title="">videos</a>
                                            </li>

                                        </ul>
                                    </div><!-- Shortcuts -->
                                </aside>
                            </div><!-- sidebar -->
                            <div class="col-lg-6">
                                <div class="central-meta">
                                    <div class="messages">
                                        <h5 class="f-title">
                                            <i class="ti-bell"></i>
                                            All Messages
                                        </h5>
                                        <div class="message-box">
                                            <ul class="peoples">
                                                <li>
                                                    <figure>
                                                        <img src="images/resources/friend-avatar2.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Molly cyrus</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar3.jpg" alt="">
                                                        <span class="status f-away"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Andrew</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure>
                                                        <img src="images/resources/friend-avatar.jpg" alt="">
                                                        <span class="status f-online"></span>
                                                    </figure>

                                                    <div class="people-name">
                                                        <span>jason bourne</span>
                                                    </div>
                                                </li>
                                                <li>

                                                    <figure><img src="images/resources/friend-avatar4.jpg" alt="">
                                                        <span class="status off-online"></span>
                                                    </figure>
                                                    <div class="people-name">
                                                        <span>Sarah Grey</span>
                                                    </div>
                                                </li>
                                            </ul>
                                            <div class="peoples-mesg-box" id="chat-container">
                                                <div class="conversation-head">
                                                    <figure><img src="images/resources/friend-avatar.jpg" alt=""></figure>
                                                    <span>jason bourne <i>online</i></span>
                                                </div>
                                                <div id="connecting">Connecting...</div>
                                                <ul class="chatting-area" id="messageArea">
<!--                                                    <li class="you">-->
<!--                                                        <figure><img src="images/resources/userlist-2.jpg" alt=""></figure>-->
<!--                                                        <p>what's liz short for? :)</p>-->
<!--                                                    </li>-->
<!--                                                    <li class="me">-->
<!--                                                        <figure><img src="images/resources/userlist-1.jpg" alt=""></figure>-->
<!--                                                        <p>Elizabeth lol</p>-->
<!--                                                    </li>-->
<!--                                                    <li class="me">-->
<!--                                                        <figure><img src="images/resources/userlist-1.jpg" alt=""></figure>-->
<!--                                                        <p>wanna know whats my second guess was?</p>-->
<!--                                                    </li>-->
<!--                                                    <li class="you">-->
<!--                                                        <figure><img src="images/resources/userlist-2.jpg" alt=""></figure>-->
<!--                                                        <p>yes</p>-->
<!--                                                    </li>-->
                                                </ul>
                                                <div class="message-text-container">
                                                    <form id="messageForm" name="messageForm">
                                                        <div class="input-message">
                                                            <textarea type="text" id="message" autocomplete="off"
                                                                      placeholder="Type a message..."></textarea>
                                                            <button type="submit" title="send"><i class="fa fa-paper-plane"></i></button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
<!--                                    <div class="messages">-->
<!--                                        <h5 class="f-title">All Messages</h5>-->
<!--                                        <div class="message-box">-->
<!--                                            <ul class="peoples" id="listFriend">-->

<!--                                            </ul>-->

<!--                                            <div class="peoples-mesg-box">-->
<!--                                                <div class="conversation-head" id="chatUserCurrent">-->

<!--                                                </div>-->

<!--                                                <ul class="chatting-area" id="chatContainer">-->

<!--                                                </ul>-->

<!--                                                <div class="message-text-container d-none" id="mainFormChat">-->

<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </div>-->
<!--                                    </div>-->
                                </div>
                            </div><!-- centerl meta -->
                            <div class="col-lg-3">
                                <aside class="sidebar static">
                                    <div class="widget">
                                        <h4 class="widget-title">Socials</h4>
                                        <ul class="socials">
                                            <li class="facebook">
                                                <a title="" href="#"><i class="fa fa-facebook"></i>
                                                    <span>facebook</span>
                                                    <ins>45 likes</ins>
                                                </a>
                                            </li>
                                            <li class="twitter">
                                                <a title="" href="#"><i class="fa fa-twitter"></i> <span>twitter</span>
                                                    <ins>25 likes</ins>
                                                </a>
                                            </li>
                                            <li class="google">
                                                <a title="" href="#"><i class="fa fa-google"></i> <span>google</span>
                                                    <ins>35 likes</ins>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="widget stick-widget">
                                        <h4 class="widget-title">Who's follownig</h4>
                                        <ul class="followers" id="listFollower">

                                        </ul>
                                    </div><!-- who's following -->
                                </aside>
                            </div><!-- sidebar -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- The Modal -->
    <div class="modal" id="modalUploadAvt">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Upload Image</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <div class="modal-body">
                    <input type="file" name="thumbnail" id="uploadThumbnail" required accept="image/*">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" id="submitUpload" data-dismiss="modal">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="modalUploadThumbnail">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Upload Image</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <div class="modal-body">
                    <input type="file" name="thumbnail" id="uploadImage" required accept="image/*">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" id="submitUploadThumbnail" data-dismiss="modal">
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <input type="text" class="d-none" id="inputAvtUploaded">
    <input type="text" class="d-none" id="inputThumbnailUploaded">

    <div class="" th:insert="fragments/main.html :: footerMain"></div>
</div>
</body>
<div th:insert="fragments/main.html :: script-main"></div>
<script th:src="@{/main/js/master.js}"></script>
<script>
    $(document).ready(function () {
        $('#submitUpload').on('click', function (e) {
            e.preventDefault();
            uploadImageMain('uploadThumbnail').then(function (response) {
                $('#btnSaveAvt').removeClass('d-none')
                $('.imgUserAvatar').addClass('d-none')
                $('.imageDemo').removeClass('d-none')
                $('.imgUserAvatarDemo').attr("src", response);
                $('#inputAvtUploaded').val(response);
            }).catch(function (error) {
                console.error('Error:', error);
            });
        });

        $('#submitUploadThumbnail').on('click', function (e) {
            e.preventDefault();
            uploadImageMain('uploadImage').then(function (response) {
                $('#btnSaveAvt').removeClass('d-none')
                $('#btnEditCoverPhoto').addClass('d-none')
                $('#btnSaveCoverPhoto').removeClass('d-none')
                $('#imgUserThumbnail').attr("src", response);
                $('#inputThumbnailUploaded').val(response);
            }).catch(function (error) {
                console.error('Error:', error);
            });
        });

        $('#btnSaveAvt').on('click', function () {
            changeAvt();
        })

        $('#btnSaveCoverPhoto').on('click', function () {
            changeThumbnail();
        })
    });

    let myToken = getCookieValue('accessToken');

    async function changeAvt() {
        try {
            let urlChangeAvt = `/api/v1/user/change-avt/` + localStorage.getItem('user_id');
            let requestData = $('#inputAvtUploaded').val();

            fetch(urlChangeAvt, {
                method: 'PUT',
                headers: {
                    'content-type': 'application/json',
                    'Authorization': `Bearer ` + `${myToken}`
                },
                body: requestData,

            })
                .then(response => {
                    alert('Change avatar success')
                    window.location.reload();
                })
                .catch(error => console.log(error));
        } catch (error) {
            console.error('Error:', error);
        }
    }

    async function changeThumbnail() {
        try {
            let urlChangeThumbnail = `/api/v1/user/change-thumbnail/` + localStorage.getItem('user_id');
            let requestData = $('#inputThumbnailUploaded').val();

            fetch(urlChangeThumbnail, {
                method: 'PUT',
                headers: {
                    'content-type': 'application/json',
                    'Authorization': `Bearer ` + `${myToken}`
                },
                body: requestData,

            })
                .then(response => {
                    alert('Change cover photo success!')
                    window.location.reload();
                })
                .catch(error => console.log(error));
        } catch (error) {
            console.error('Error:', error);
        }
    }

</script>
<script th:src="@{/main/js/test.js}"></script>
<!--<script th:src="@{/main/js/message.js}"></script>-->
<script>

</script>
</html>